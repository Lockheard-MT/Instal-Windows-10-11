## 1. Создание загрузочной флэшки

### 1.1. Скачать программу для создания носителя
>[!TIP]
> - Флэшка не менее 8 Гб;
> - Любой работающий компьютер или ноутбук;
> - Подключение к Интернету для скачивания образа операционной системы (далее по тексту ОС)

Способ создания загрузочной флэшки без подключения к Интернету будет описан в разделе Установка любой ОС.

>[!TIP]
>- [Windows 10](https://go.microsoft.com/fwlink/?LinkId=691209)
>- [Windows 11](https://go.microsoft.com/fwlink/?linkid=2156295)

Для скачивания программы вручную необходимо посетить сайт Microsoft:<br>
- для Windows 10<br>
https://www.microsoft.com/en-us/software-download/windows10<br>
- для Windows 11<br>
https://www.microsoft.com/software-download/windows11<br>

Затем на странице сайта в поле Create Windows 11 Installation Media нажать <span style="color:#a64d79">**Download Now**</span>, загрузиться приложение <span style="color:#a64d79">**MediaCreationTool_Win11_23H2.exe**</span>, и запустить программы будет выглядеть следующим образом:
![[Pasted image 20240305164654.png]]
___
### 1.2. Подготовка загрузочной флэшки
Этот пункт может выполняться на любом компьютере, не обязательно на том на котором должна быть выполнена переустановка или установка ОС.

Вставить флэшку в компьютер.
>[!WARNING]
>Данные с флэшки будут удалены

Запустить скаченное приложение. Откроется диалоговое окно, принять лицензионное соглашение, выбрать язык и в качестве носителя указать <span style="color:#a64d79">**USB-устройство флэш-памяти**</span>, см. скрин ниже
![[Pasted image 20240305164814.png]]

>[!WARNING]  
>Необходимо убедиться, что выбрана правильная флэшка, данные на ней будут удалены

Выбрать в диалоговом окне подготовленную флэшку и нажать <span style="color:#a64d79">**Далее**</span>.
![[Pasted image 20240305164828.png]]

Дождаться окончания создания загрузочной флэшки.
![[Pasted image 20240305164844.png]]

После завершения нажать <span style="color:#a64d79">**Готово**</span>.
___
### 1.3. Добавление возможности выбора устанавливаемой версии ОС, например Windows 11 Pro

Создать текстовый файл, например в Блокноте, со следующим содержанием:
```
[EditionID]
[Channel]
Retail
```
Затем сохранить под имением <span style="color:#a64d79">**ei.cfg**</span>, файл разместить на созданную загрузочную флэшку в корневой каталог.
## 2. Запись Windows
### 2.1. Запуск программы установки
Вставить созданную флэшку в ПК на который планируется установить Windows. Запустить компьютер и в среде Bios в качестве загрузочного диска указать вставленную Флэшку. Для этого на выключенном ПК, после нажатия на кнопку питания следует незамедлительно часто нажимать на клавишу <kbd><span style="color:#59afe1">F2</kbd> или <kbd><span style="color:#59afe1">Delete</kbd> (в зависимости от производителя может быть необходима та или другая, следует попробовать сначала <kbd><span style="color:#59afe1">F2</kbd>, на некоторых системах для активации клавиши <kbd><span style="color:#59afe1">F2</span></kbd> нужно зажимать еще и <kbd><span style="color:#59afe1">fn</kbd>, затем если не выйдет запустить среду <span style="color:#a64d79">**Bios**</span>, то попробовать <kbd><span style="color:#59afe1">Delete</kbd>, если же и так не получится, стоит поискать справку в Интернете с запросом запуск Bios указав модель компьютера или ноутбука). В <span style="color:#a64d79">**Bios**</span> нужной найти пункт <span style="color:#a64d79">**Boot**</span> и в нем указать загрузочную флэшку в качестве устройства запуска ОС, её легче всего будет найти из списка обратив внимание на объем, как правило объем жестких дисков исчисляется сотнями Гигабайт и флэшка на их фоне будет выделяться. На этот процесс уйдет какое-то время, но как правило из контекста понятно что нужно будет сделать. Не стоит пугаться, достаточно просто уверенно исследовать Bios не смотря на то, что иногда поддержка мыши там отсутствует, пунктов в его меню не так много и в целом всё должно получиться. После чего нужно сохранить изменения и перезагрузить ПК, для этого нужно будет нажать клавишу <kbd><span style="color:#59afe1">F10</kbd> и в появившемся окне подтвердить намерение сохранения изменений и перезагрузки компьютера нажатием клавиши <kbd><span style="color:#59afe1">Enter</kbd>.

После перезапуска компьютер загрузиться с вставленной в него загрузочной флэшки. Процесс установки не сложный, выбор языка, жесткого диска на который будет установлена ОС и т.д. В окне выбора на какое устройство будет установлена ОС будет отображено несколько значений, например, несколько "Диск" 0, "Диск 1" и т.д. Каждый диск это отдельный физический диск, который в свою очередь разделен системой на отдельный разделы. Можно их все удалить и создать заново из неразмеченной области, которая добавиться отдельным пунктом после удаления. Однако если на них есть важные файлы, то трогать их не стоит. Например, на компьютере есть два физических носителя, точнее жестких диска, один диск на котором уже установлена ОС и этот диск объемом 60 Гб, он будет отмечен как три разных по объему раздела "Диск 0", а второй для хранения файлов на 500 Гб будет отмечен как два раздела "Диск 1". Если на диске с ОС (Диск 0) нет важных файлов, да в принципе их в любом случае нужно будет скопировать в другое место, то все разделы "Диск 0" стоит удалить пунктом стереть и выбрав неразмеченную область нажатием клавиши установить продолжить установку. Установка продолжиться на диск 60 Гб так как неразмеченная область состояла из его объёма памяти, а диск на 500 Гб будет не тронут и доступ к файлам будет не нарушен, ими можно будет пользоваться в дальнейшем корректно. Названия дисков, их объем и количество разделов были придуманы для примера, на всех системах картина будет различна, главное понимать суть.
___
### 2.2. Обход блокировки установки (для старых ПК)
В ходе установки появится предупреждение о несоответствии оборудования минимальным системным требованиям. Не закрывая это окно, вызываем командную строку комбинацией клавиш <kbd><span style="color:#59afe1">Shift</kbd>+<kbd><span style="color:#59afe1">F10<</kbd> и вводим в ней команду regedit, которая запустит редактор Реестра, в разделе:
```
HKEY_LOCAL_MACHINE\SYSTEM\Setup
```

Создать раздел <span style="color:#a64d79">**LabConfig**</span>
В новом разделе создаём три 32-битных параметра DWORD
(правая кнопка мыши «Создать»> «Значение DWORD»).
Параметры должны называться так: 
```
BypassTPMCheck
```
```
BypassRAMCheck
```
```
BypassSecureBootCheck
```

Каждому из них необходимо присваиваем значение 1, для этого нужно выполнить двойное нажатие правой кнопкой мыши (далее по тексту х2ПКМ) по созданному параметру и в поле <span style="color:#a64d79">**Значение**</span>, изменить 0 на 1, затем нажать <span style="color:#a64d79">**OK**</span>. Повторить для всех трех созданных параметров.
___
### 2.3. Создание локальной учетной записи (без учетной записи Microsoft и без Интернета)
Дойдя до экрана - ==Давайте подключим вас к сети== нажмите
клавиши <kbd><span style="color:#59afe1">Shift</span></kbd>+<kbd><span style="color:#59afe1">F10</span></kbd>, это откроет командную строку, ввести команду
```
oobe\bypassnro
```
Компьютер перезагрузится, и в процессе установки появиться
пункт – ==У меня нет Интернета==, позволяющий создать локальную
учетную запись без подключенного Интернета и создания или прикрепления учетной записи Microsoft.
___
